"use strict";var g=Object.defineProperty;var S=(i,t,e)=>t in i?g(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var l=(i,t,e)=>(S(i,typeof t!="symbol"?t+"":t,e),e);var h=(i,t,e)=>new Promise((r,s)=>{var a=n=>{try{d(e.next(n))}catch(o){s(o)}},c=n=>{try{d(e.throw(n))}catch(o){s(o)}},d=n=>n.done?r(n.value):Promise.resolve(n.value).then(a,c);d((e=e.apply(i,t)).next())});Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var p=(i=>(i.de="de",i.fr="fr",i.en="en",i.it="it",i.nl="nl",i))(p||{});class m{constructor(t,e,r){l(this,"projectSlug");l(this,"entity","person");l(this,"apiUrl","https://api.metagrid.ch");this.projectSlug=t,this.entity=e,typeof r!="undefined"&&(this.apiUrl=r)}fetch(t,e="de",r=!1){return h(this,null,function*(){const s=[];s.push(`include=${String(r)}`),s.push(`language=${e}`);try{const a=yield fetch(`${this.apiUrl}/widget/${this.projectSlug}/${this.entity}/${t}.json?${s.join("&")}`);return a.ok?this.buildResponse(a,this.transform(yield a.json())):this.buildResponse(a)}catch(a){return this.buildResponse({statusCode:0,found:!1,error:"unknown network error"})}})}buildResponse(t,e=[]){return"ok"in t?{status:{statusCode:t.status,found:t.status===200,error:t.statusText},data:e}:{status:t,data:[]}}transform(t){return Object.keys(t[0]).map(e=>{const r=t[0][e];return typeof r=="string"?{provider:e,url:r}:{provider:e,url:r.url,shortDescription:r.short_description,longDescription:r.long_description}})}static create(t,e="person"){return new m(t,e)}}function b(i,t,e,r="de",s=!1){return h(this,null,function*(){const c=yield m.create(t).fetch(e,r,s);if(c.status.found){const d=document.createElement("ul");d.classList.add("metagrid-list"),c.data.forEach(n=>{const o=n,f=document.createElement("li");f.classList.add("metagrid-item");const u=document.createElement("a");u.classList.add("metagrid-link"),u.href=o.url,u.innerText=o.provider,u.target="_blank",typeof o.longDescription!="undefined"&&(u.title=o.longDescription),f.append(u),d.append(f)}),i.append(d),i.append(w(r))}else console.info(`Metagrid didn't find a concordance. Statuscode: ${c.status.statusCode}, error: ${c.status.error}`)})}function w(i){const t=document.createElement("div");t.classList.add("metagrid-credit");let e="the networking initiative of the SAHS";switch(i){case p.de:e="die Vernetzungsinitiative der SAGW";break;case p.fr:e="l\u2019initiative de mise en r\xE9seau de l\u2019ASSH";break;case p.it:e="l\u2019iniziativa di messa in rete dell\u2019ASSU";break}return t.innerHTML=`Links powered by <a href="https://www.metagrid.ch" target="_blank">Metagrid</a> \u2013 ${e}`,t}exports.credit=w;exports.widget=b;
//# sourceMappingURL=metagrid-widget.cjs.js.map
